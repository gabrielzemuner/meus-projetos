---
title: Promises
description: "Como lidar com código assíncrono: then/catch/finally e async/await."
slug: js-antes-do-react/09-promises
---

import PlaygroundLinks from "../../../components/PlaygroundLinks";

Nem tudo na programação é **síncrono** (executa “na hora”, em sequência). Algumas operações demoram:

- buscar dados em um servidor (latência)
- ler arquivos
- esperar timers (`setTimeout`)
- acessar banco de dados

Para isso existe **código assíncrono**, e no JavaScript a base disso são as **Promises**.

:::note
Uma `Promise` representa um valor que **ainda vai chegar** no futuro:
- `resolve(valor)` → sucesso (entrega o valor)
- `reject(erro)` → falha (entrega um erro)
:::

---

## Exemplo 1: criando uma Promise (com `setTimeout`)

Aqui simulamos uma função que “demora 2s” para devolver a soma.

```js
const somaDoisNumeros = (a, b) => {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      resolve(a + b);
    }, 2000);
  });
};

somaDoisNumeros(1, 3)
  .then((soma) => {
    console.log("resultado:", soma); // => 4 (depois de 2s)
  })
  .catch((err) => {
    console.log("erro:", err);
  });
```

---

## Exemplo 2: `fetch` com then/catch/finally

Buscar dados no GitHub é um exemplo clássico de promise.

```js
fetch("https://api.github.com/users/diego3g")
  .then((response) => {
    return response.json();
  })
  .then((body) => {
    console.log(body);
  })
  .catch((err) => {
    console.log(err);
  })
  .finally(() => {
    console.log("executou fetch");
  });
```

:::tip
Se em algum editor online o `fetch` der erro, pode ser **CORS** ou restrição do ambiente.
Teste no browser (console) ou use os exercícios com `setTimeout`.
:::

---

## Exemplo 3: `async/await` (forma moderna)

A mesma lógica do exemplo 2, só que com `async/await`.

```js
async function buscaDadosNoGithub() {
  try {
    const response = await fetch("https://api.github.com/users/diego3g");
    const body = await response.json();

    console.log(body);
  } catch (err) {
    console.log(err);
  } finally {
    console.log("executou async function");
  }
}

buscaDadosNoGithub();
```

---

## Resumo final

- `Promise` → valor futuro (sucesso ou erro)
- `.then(...)` → quando der certo
- `.catch(...)` → quando der errado
- `.finally(...)` → sempre executa
- `async/await` → sintaxe moderna (por cima de promises)
- `try/catch/finally` → para tratar erros no `await`

---

## Exercícios

Tente fazer **sem olhar a resposta**. Depois confira e compare com o seu.

<PlaygroundLinks />

---

### 1) Promise que resolve depois de 1s

Crie uma função `esperar1s()` que retorna uma Promise que resolve com `"ok"` após 1 segundo.

<details>
  <summary><strong>Ver resposta sugerida</strong></summary>

```js
function esperar1s() {
  return new Promise((resolve) => {
    setTimeout(() => resolve("ok"), 1000);
  });
}

esperar1s().then((v) => console.log(v)); // => "ok"
```

</details>

---

### 2) Promise que rejeita

Crie uma função `falhar()` que retorna uma Promise que rejeita com um erro `"deu ruim"` após 500ms.

<details>
  <summary><strong>Ver resposta sugerida</strong></summary>

```js
function falhar() {
  return new Promise((resolve, reject) => {
    setTimeout(() => reject(new Error("deu ruim")), 500);
  });
}

falhar()
  .then(() => console.log("ok"))
  .catch((err) => console.log("erro:", err.message));
```

</details>

---

### 3) Usar `finally`

Crie uma Promise (pode usar `falhar()` do exercício anterior) e garanta que `"finalizou"` apareça no final, dando certo ou errado.

<details>
  <summary><strong>Ver resposta sugerida</strong></summary>

```js
function falhar() {
  return new Promise((resolve, reject) => {
    setTimeout(() => reject(new Error("deu ruim")), 500);
  });
}

falhar()
  .then(() => console.log("ok"))
  .catch((err) => console.log("erro:", err.message))
  .finally(() => console.log("finalizou"));
```

</details>

---

### 4) Converter then/catch para async/await

Dado:

```js
function somaDoisNumeros(a, b) {
  return new Promise((resolve) => {
    setTimeout(() => resolve(a + b), 1000);
  });
}
```

Crie uma função `async` que chama essa soma com `await` e imprime o resultado.

<details>
  <summary><strong>Ver resposta sugerida</strong></summary>

```js
function somaDoisNumeros(a, b) {
  return new Promise((resolve) => {
    setTimeout(() => resolve(a + b), 1000);
  });
}

async function executar() {
  const soma = await somaDoisNumeros(2, 5);
  console.log("soma:", soma); // => 7
}

executar();
```

</details>

---

### 5) Tratar erro com try/catch

Crie uma função `async` que chama `falhar()` (do exercício 2) com `await` e trate o erro com `try/catch`, imprimindo `err.message`.

<details>
  <summary><strong>Ver resposta sugerida</strong></summary>

```js
function falhar() {
  return new Promise((resolve, reject) => {
    setTimeout(() => reject(new Error("deu ruim")), 500);
  });
}

async function executar() {
  try {
    await falhar();
  } catch (err) {
    console.log("erro:", err.message);
  } finally {
    console.log("finalizou");
  }
}

executar();
```

</details>
